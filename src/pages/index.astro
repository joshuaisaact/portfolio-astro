---
import Contact from "../components/Contact.astro";
import Navbar from "../components/Navbar.astro";
import Projects from "../components/Projects.astro";
import Section from "../components/Section.astro";
import Skills from "../components/Skills.astro";
import Welcome from "../components/Welcome.astro";
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";

// Fetch projects from content collection
const allProjects = await getCollection("projects");

// Separate application projects from utility projects
const applicationProjects = allProjects
	.filter((p) => !p.data.projectType || p.data.projectType === "application")
	.sort((a, b) => (a.data.order ?? 999) - (b.data.order ?? 999))
	.map((p) => p.data);

const utilityProjects = allProjects
	.filter((p) =>
		["tool", "library", "starter"].includes(p.data.projectType || ""),
	)
	.sort((a, b) => (a.data.order ?? 999) - (b.data.order ?? 999))
	.map((p) => p.data);
---

<a
	href="#main-content"
	class="sr-only focus:not-sr-only focus:absolute focus:z-50 focus:p-4 focus:bg-white dark:focus:bg-gray-900 focus:text-blue-600"
>
	Skip to main content
</a>

<Layout>
	<Navbar />
	<Welcome />
	<Section id="skills" title="Skills">
		<Skills />
	</Section>
	<Section id="projects" title="Featured Applications">
		<Projects projects={applicationProjects} projectType="application" />
	</Section>
	<Section id="dev-tools" title="Developer Tools & Utilities" cardType="full">
		<Projects
			projects={utilityProjects}
			projectType="tool"
			cardType="minimal"
		/>
	</Section>
	<Section id="blog" title="Blog">
		<!-- <Blog /> -->
	</Section>
	<Section id="contact" title="Contact">
		<Contact />
	</Section>
</Layout>
