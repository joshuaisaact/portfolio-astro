---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

interface Props {
  slug: string;
  metadata: {
    title: string;
    date: string;
    featured_image?: ImageMetadata;
    hide_featured_image?: boolean;
    excerpt: string;
    tags: string[];
  };
  index?: number;
}

const { slug, metadata, index = 0 } = Astro.props;

const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};
---

<a href={`/blog/${slug}`} class="block h-full" role="listitem">
  <div
    class="group
        relative overflow-hidden
        bg-linear-to-b from-white to-gray-50
        dark:from-gray-800 dark:to-gray-850
        rounded-lg shadow-sm
        ring-1 ring-gray-900/5
        transition-all duration-300
        hover:shadow-md hover:-translate-y-0.5 h-full flex flex-col"
  >
    {metadata.featured_image && (
      <div
        class="relative aspect-3/2 sm:aspect-4/3 overflow-hidden bg-gray-100 dark:bg-gray-800"
      >
        <Image
          src={metadata.featured_image}
          alt={metadata.title}
          width={800}
          height={600}
          loading={index < 6 ? "eager" : "lazy"}
          class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
        />
      </div>
    )}
    <div class="p-4 sm:p-6">
      {/* Date */}
      <time
        datetime={metadata.date}
        class="text-sm text-gray-600 dark:text-gray-400 mb-2 block"
      >
        {formatDate(metadata.date)}
      </time>

      <h2
        class="text-lg sm:text-xl font-semibold text-gray-900 dark:text-gray-100
            group-hover:text-blue-600 dark:group-hover:text-blue-400
            transition-colors line-clamp-2 mb-2"
      >
        {metadata.title}
      </h2>
      <p
        class="text-sm sm:text-base text-gray-600 dark:text-gray-300
            line-clamp-4 mb-4 grow"
      >
        {metadata.excerpt}
      </p>
    </div>
  </div>
</a>
